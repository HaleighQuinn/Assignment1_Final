"UsageByZip.csv"
)
if((quarter %in% 3:4) & (year %in% 2020)){
next
}
print(filename)
}
}
}
temp <- read_csv(filename)
pge_elec_gas <- rbind(pge_elec_gas,temp)
saveRDS(pge_elec_gas, "pge_elec_gas.rds")
pge_elec_gas <- readRDS("~/GitHub/Assignment1_Final/pge_elec_gas.rds")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
years <- c(2017:2020)
quarters <- 1:4
types <- c("Electric", "Gas")
pge_elec_gas <- NULL
for(quarter in quarters){
for(year in years){
for(type in types){
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
if((quarter %in% 3:4) & (year %in% 2020)){
next
}
print(filename)
}
}
}
temp <- read_csv(filename)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
for (quarter in quarters){
for (year in years){
for type in types{
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
for (quarter in quarters){
for (year in years){
for (type in types){
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
print(filename)
}
}
}
temp <- read_csv(filename)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
for (quarter in quarters){
for (year in years){
for (type in types){
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
print(filename)
}
}
}
temp <- read_csv(filename)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
}
}
}
temp <- read_csv(filename)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
pge_elec_gas <- NULL
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
}
}
}
temp <- read_csv(filename)
pge_elec_gas <- rbind(pge_elec_gas, temp)
View(pge_elec_gas)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
pge_elec_gas <- NULL
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
}
}
}
temp <- read_csv(filename)
pge_elec_gas <- rbind(pge_elec_gas, temp)
View(pge_elec_gas)
View(pge_elec_gas)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
years <- 2017:2020
quarters <- 1:4
types <- c("Electric", "Gas")
pge_elec_gas <- NULL
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
pge_elec_gas <- rbind(pge_elec_gas, temp)
}
}
}
quarter = 1 year = 2017
quarter = 1
year = 2017
type = "Gas"
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
temp <- read_csv(filename)
View(temp)
if(type %in% "Gas"){
print(temp)
}
if(type %in% "Gas"){
print(temp)
temp <- temp %>%
mutate(TOTALKBTU = 99 * TOTALTHM)
}
temp <- temp %>%
mutate(TOTALKBTU = 99 * TOTALTHM) %>%
select(-TOTALTHM, -AVERAGETHM)
pge_elec_gas <- NULL
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
if(type %in% "Gas"){
print(temp)
temp <- temp %>%
mutate(TOTALKBTU = 99 * TOTALTHM) %>%
select(-TOTALTHM, -AVERAGETHM)
} else {
temp <- temp %>%
mutate(TOTALKBTU = 3.1 * TOTALKWH) %>%
select(-TOTALKWH, -AVERAGEKWH)
}
pge_elec_gas <- rbind(pge_elec_gas, temp)
}
}
}
View(pge_elec_gas)
View(pge_elec_gas)
pge_elec_gas <- NULL
pge_elec_gas <- NULL
for (quarter in quarters){
for (year in years){
for (type in types){
if ((quarter %in% 3:4) & (year %in% 2020)){
next
}
filename <-
paste0(
"PGE_",
year,
"_Q",
quarter,
"_",
type,
"UsageByZip.csv"
)
print(filename)
temp <- read_csv(filename)
if(type %in% "Gas"){
print(temp)
temp <- temp %>%
mutate(TOTALKBTU = 100 * TOTALTHM) %>%
select(-TOTALTHM, -AVERAGETHM)
} else {
temp <- temp %>%
mutate(TOTALKBTU = 3.412 * TOTALKWH) %>%
select(-TOTALKWH, -AVERAGEKWH)
}
pge_elec_gas <- rbind(pge_elec_gas, temp)
}
}
}
pge_res_com <-
filter(
pge_elec_gas,
CUSTOMERCLASS %in%
c(
"Elec- Residential ",
"Gas- Residential",
"Elec- Commercial",
"Gas- Commercial"
)
)
View(pge_res_com)
View(pge_elec_gas)
library(tidyverse)
library(sf)
library(tigris)
library(leaflet)
usa_zips <-
zctas(cb = T, progress_bar = F)
bay_zips <-
usa_zips %>%
st_centroid() %>%
.[bay_counties, ] %>%
st_set_geometry(NULL) %>%
left_join(usa_zips %>% select(GEOID10)) %>%
st_as_sf()
library(tidyverse)
library(sf)
library(tigris)
library(leaflet)
usa_zips <-
zctas(cb = T, progress_bar = F)
bay_county_names <-
c(
"Alameda",
"Contra Costa",
"Marin",
"Napa",
"San Francisco",
"San Mateo",
"Santa Clara",
"Solano",
"Sonoma"
)
bay_counties <-
ca_counties %>%
filter(NAME %in% bay_county_names)
library(tidyverse)
library(sf)
library(tigris)
library(leaflet)
ca_counties <- counties("CA", cb = T, progress_bar = F)
st_crs(ca_counties)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) %>%
st_transform(st_crs(ca_counties))
usa_zips <-
zctas(cb = T, progress_bar = F)
bay_county_names <-
c(
"Alameda",
"Contra Costa",
"Marin",
"Napa",
"San Francisco",
"San Mateo",
"Santa Clara",
"Solano",
"Sonoma"
)
bay_counties <-
ca_counties %>%
filter(NAME %in% bay_county_names)
bay_zips <-
usa_zips %>%
st_centroid() %>%
.[bay_counties, ] %>%
st_set_geometry(NULL) %>%
left_join(usa_zips %>% select(GEOID10)) %>%
st_as_sf()
pge_res_elec <-
pge_res_com %>%
filter(CUSTOMERCLASS == "Elec- Residential") %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKWH = sum(TOTALKWH, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
View(bay_counties)
View(bay_zips)
View(pge_res_com)
pge_bayzips <-
pge_bayzips <-
pge_res_com %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
View(pge_bayzips)
View(pge_res_com)
View(pge_elec_gas)
View(bay_counties)
View(pge_bayzips)
View(bay_zips)
View(pge_bayzips)
View(pge_res_com)
View(pge_bayzips)
View(pge_res_com)
knitr::opts_chunk$set(echo = TRUE)
months <- 1:12
months <- 1:12
pge_bayzips <-
for(month in months){
pge_res_com %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_res_com$ZIPCODE)
}
pge_bayzips <- NULL
for(month in months){
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_res_com$ZIPCODE)
pge_bayzips <- pge_res_com
}
months <- 1:12
pge_bayzips <- NULL
for(month in months){
pge_res_com_mutatate <-
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_res_com$ZIPCODE)
pge_bayzips <- pge_res_com_mutate
}
months <- 1:12
pge_bayzips <- NULL
for(month in months){
pge_res_com_mutate <-
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
left_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_res_com$ZIPCODE)
pge_bayzips <- pge_res_com_mutate
}
View(bay_zips)
