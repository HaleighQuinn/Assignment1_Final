mutate(
pge_rc_bayzips,
month_consec = c(1:42)
)
months <- 1:42
View(pge_res_com)
View(pge_elec_gas)
pge_res_com <-
if (year = 2017){
x <- 2017
if (x > 2017){
MONTH = 1:12
}
View(pge_res_com)
(x)
View(pge_res_com)
View(pge_rc_bayzips)
class(pge_rc_bayzips$MONTH)
if (year = 2017){
if(year = 2017){
if(year == 2017){
pge_rc_bayzips <- pge_rc_bayzips %>%
MONTH = 1:12
}
View(pge_rc_bayzips)
if(year == 2017){
pge_rc_bayzips <- pge_rc_bayzips %>%
MONTH = 1:12
} else {
pge_rc_bayzips <- pge_rc_bayzips %>%
MONTH = 13:42
}
View(pge_rc_bayzips)
if(year == 2017){
pge_res_com <- pge_res_com %>%
MONTH = 1:12
} else {
pge_res_com <- pge_res_com %>%
MONTH = 13:42
}
if(year == 2017){
pge_res_com <- pge_res_com %>%
MONTH = 1:12
}
View(pge_res_com)
if(year != 2017){
pge_res_com <- pge_res_com %>%
MONTH = 13:42
}
if(YEAR = 2017){
if(YEAR == 2017){
pge_res_com <- pge_res_com
mutate(
MONTH = c(1:12)
)
} else if(YEAR == 2018){
mutate(
MONTH = c(13:24)
)
} else if(YEAR == 2019){
mutate(
MONTH = c(25:37)
)
} else if(YEAR == 2020){
mutate(
MONTH = C(38:42)
)
}
if(year == 2017){
pge_res_com <- pge_res_com
mutate(
MONTH = c(1:12)
)
} else if(year == 2018){
mutate(
MONTH = c(13:24)
)
} else if(year == 2019){
mutate(
MONTH = c(25:37)
)
} else if(year == 2020){
mutate(
MONTH = C(38:42)
)
}
View(pge_rc_bayzips)
View(pge_rc_bayzips)
View(pge_rc_bayzips)
View(pge_rc_bayzips)
View(pge_rc_bayzips)
knitr::opts_chunk$set(echo = TRUE)
if(month %in% 1:12){
pge_res_com <- pge_res_com %>%
YEAR == 2017
} else {
YEAR > 2017
}
if(month %in% 1:12){
pge_res_com <- pge_res_com
YEAR == 2017
} else {
YEAR > 2017
}
View(pge_rc_bayzips)
pge_rc_bayzips <-
mutate(
DATE = as.yearmon(paste(df$YEAR, df$MONTH), "%Y %m")
)
mutate(pge_rc_bayzips,
DATE = as.yearmon(paste(df$YEAR, df$MONTH), "%Y %m")
)
pge_rc_bayzips <- pge_rc_bayzips %>%
mutate(
DATE = as.yearmon(paste(df$YEAR, df$MONTH), "%Y %m")
)
mutate(
DATE = as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-
mutate(
DATE = as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-  as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips$Date <-
mutate(
DATE = DATE %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-
pge_rc_bayzips %>%
mutate(
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
require(zoo)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips$Date <-
pge_rc_bayzips
mutate(
DATE = DATE %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
library(dplyr)
pge_rc_bayzips$Date <-
pge_rc_bayzips
mutate(
DATE = DATE %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
library(dplyr)
pge_rc_bayzips$Date <-
pge_rc_bayzips
mutate(
"YEAR" & "MONTH" = DATE %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
library(dplyr)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
library(dplyr)
zoo::as.yearmon
install.packages("date")
library(date)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
library(date)
library(dplyr)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
library(date)
library(dplyr)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips <-
mutate(
YEAR = DATE %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips <-
mutate(
YEAR = YEAR %>% as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
library(date)
library(dplyr)
pge_rc_bayzips <-
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
install.packages("zoo")
library(zoo)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips <-
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
pge_rc_bayzips <-
pge_elec_gas %>%
filter(CUSTOMERCLASS %in% c("Gas- Residential", "Elec- Residential", "Gas-Commercial", "Elec- Commercial")) %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE, CUSTOMERCLASS, MONTH, YEAR) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
right_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
library(tidyverse)
library(sf)
library(tigris)
library(leaflet)
library (dplyr)
ca_counties <- counties("CA", cb = T, progress_bar = F)
st_crs(ca_counties)
projection <- "+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"
ca_counties_transformed <-
ca_counties %>%
st_transform(4326) %>%
st_transform(26910) %>%
st_transform(projection) %>%
st_transform(st_crs(ca_counties))
usa_zips <-
zctas(cb = T, progress_bar = F)
bay_county_names <-
c(
"Alameda",
"Contra Costa",
"Marin",
"Napa",
"San Francisco",
"San Mateo",
"Santa Clara",
"Solano",
"Sonoma"
)
bay_cbgs <-
bay_county_names %>%
map_dfr(function(county) {
block_groups("CA", county, cb = T, progress_bar = F)
})
bay_counties <-
ca_counties %>%
filter(NAME %in% bay_county_names)
bay_zips <-
usa_zips %>%
st_centroid() %>%
.[bay_counties, ] %>%
st_set_geometry(NULL) %>%
left_join(usa_zips %>% select(GEOID10)) %>%
st_as_sf()
colnames(pge_elec_gas)
pge_rc_bayzips <-
pge_elec_gas %>%
filter(CUSTOMERCLASS %in% c("Gas- Residential", "Elec- Residential", "Gas-Commercial", "Elec- Commercial")) %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE, CUSTOMERCLASS, MONTH, YEAR) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
right_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_rc_bayzips$ZIPCODE)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <-
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
View(pge_rc_bayzips)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <-
pge_rc_bayzips %>%
mutate(
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <-
mutate(
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-
mutate(pge_rc_bayzips,
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <-
mutate(pge_rc_bayzips %>%
as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-
mutate(pge_rc_bayzips %>%
as.yearmon(paste(YEAR, MONTH), "%Y %m")
)
pge_rc_bayzips$Date <-
mutate(pge_rc_bayzips %>%
as.yearmon(paste("YEAR", "MONTH"), "%Y %m")
)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
View(pge_res_com)
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = DATE %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = DATE %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = Date %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
pge_bay_chart %>%
ggplotly() %>%
layout(
xaxis = list(fixedrange = T),
yaxis = list(fixedrange = T)
) %>%
config(displayModeBar = F)
pge_rc_bayzips <-
pge_elec_gas %>%
filter(CUSTOMERCLASS %in% c("Gas- Residential", "Elec- Residential", "Gas- Commercial", "Elec- Commercial")) %>%
mutate(
ZIPCODE = ZIPCODE %>% as.character()
) %>%
group_by(ZIPCODE, CUSTOMERCLASS, MONTH, YEAR) %>%
summarize(
TOTALKBTU = sum(TOTALKBTU, na.rm = T)
) %>%
right_join(
bay_zips %>% select(GEOID10),
by = c("ZIPCODE" = "GEOID10")
) %>%
st_as_sf() %>%
st_transform(4326)
class(pge_rc_bayzips$ZIPCODE)
View(pge_rc_bayzips)
library(date)
library(zoo)
library(dplyr)
pge_rc_bayzips$Date <- as.yearmon(paste(pge_rc_bayzips$YEAR, pge_rc_bayzips$MONTH), "%Y %m")
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = MONTH %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
pge_bay_chart %>%
ggplotly() %>%
layout(
xaxis = list(fixedrange = T),
yaxis = list(fixedrange = T)
) %>%
config(displayModeBar = F)
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = YEAR %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
pge_bay_chart %>%
ggplotly() %>%
layout(
xaxis = list(fixedrange = T),
yaxis = list(fixedrange = T)
) %>%
config(displayModeBar = F)
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = Date %>% factor(1:42),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
pge_bay_chart %>%
ggplotly() %>%
layout(
xaxis = list(fixedrange = T),
yaxis = list(fixedrange = T)
) %>%
config(displayModeBar = F)
library(tidyverse)
library(plotly)
pge_bay_chart <-
pge_rc_bayzips %>%
ggplot() +
geom_bar(
aes(
x = Date %>% factor(),
y = TOTALKBTU,
fill = CUSTOMERCLASS
),
stat = "identity",
position = "stack"
) +
labs(
x = "Month",
y = "KBTU",
title = "9 Bay Area Counties Monthly Electric & Gas Usage, 2017-2020",
fill = "Energy Type"
)
pge_bay_chart
pge_bay_chart %>%
ggplotly() %>%
layout(
xaxis = list(fixedrange = T),
yaxis = list(fixedrange = T)
) %>%
config(displayModeBar = F)
