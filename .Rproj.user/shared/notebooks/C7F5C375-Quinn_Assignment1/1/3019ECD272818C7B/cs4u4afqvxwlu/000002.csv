"0","library(tidyverse)"
"0","library(sf)"
"2","Linking to GEOS 3.8.0, GDAL 3.0.4, PROJ 6.3.1
"
"0","library(tigris)"
"2","To enable 
caching of data, set `options(tigris_use_cache = TRUE)` in your R script or .Rprofile.
"
"0","library(leaflet)"
"0","library (dplyr)"
"0",""
"0",""
"0","ca_counties <- counties(""CA"", cb = T, progress_bar = F)"
"2","Using FIPS code '06' for state 'CA'
"
"0","st_crs(ca_counties)"
"1","Coordinate Reference System:"
"1","
"
"1","  User input:"
"1"," "
"1","NAD83"
"1"," "
"1","
"
"1","  wkt:
"
"1",""
"1","GEOGCRS[""NAD83"",
    DATUM[""North American Datum 1983"",
        ELLIPSOID[""GRS 1980"",6378137,298.257222101,
            LENGTHUNIT[""metre"",1]]],
    PRIMEM[""Greenwich"",0,
        ANGLEUNIT[""degree"",0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[""latitude"",north,
            ORDER[1],
            ANGLEUNIT[""degree"",0.0174532925199433]],
        AXIS[""longitude"",east,
            ORDER[2],
            ANGLEUNIT[""degree"",0.0174532925199433]],
    ID[""EPSG"",4269]]"
"1",""
"1","
"
"0","projection <- ""+proj=utm +zone=10 +ellps=GRS80 +datum=NAD83 +units=ft +no_defs"""
"0",""
"0","ca_counties_transformed <- "
"0","  ca_counties %>% "
"0","  st_transform(4326) %>% "
"0","  st_transform(26910) %>% "
"0","  st_transform(projection) %>% "
"0","  st_transform(st_crs(ca_counties))"
"0",""
"0","usa_zips <- "
"0","  zctas(cb = T, progress_bar = F)"
"2","ZCTAs can take several minutes to download.  To cache the data and avoid re-downloading in future R sessions, set `options(tigris_use_cache = TRUE)`
"
"0","bay_county_names <-"
"0","  c("
"0","    ""Alameda"","
"0","    ""Contra Costa"","
"0","    ""Marin"","
"0","    ""Napa"","
"0","    ""San Francisco"","
"0","    ""San Mateo"","
"0","    ""Santa Clara"","
"0","    ""Solano"","
"0","    ""Sonoma"""
"0","  )"
"0",""
"0","bay_cbgs <- "
"0","  bay_county_names %>% "
"0","  map_dfr(function(county) {"
"0","    block_groups(""CA"", county, cb = T, progress_bar = F)"
"0","  })"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '001' for 'Alameda County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '013' for 'Contra Costa County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '041' for 'Marin County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '055' for 'Napa County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '075' for 'San Francisco County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '081' for 'San Mateo County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '085' for 'Santa Clara County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '095' for 'Solano County'
"
"2","Using FIPS code '06' for state 'CA'
"
"2","Using FIPS code '097' for 'Sonoma County'
"
"0","bay_counties <-"
"0","  ca_counties %>%"
"0","  filter(NAME %in% bay_county_names)"
"0",""
"0",""
"0","bay_zips <-"
"0","  usa_zips %>% "
"0","  st_centroid() %>% "
"0","  .[bay_counties, ] %>% "
"0","  st_set_geometry(NULL) %>% "
"0","  left_join(usa_zips %>% select(GEOID10)) %>% "
"0","  st_as_sf()"
"2","st_centroid assumes attributes are constant over geometries of x"
"2","st_centroid does not give correct centroids for longitude/latitude data"
"2","although coordinates are longitude/latitude, st_intersects assumes that they are planar
"
"2","although coordinates are longitude/latitude, st_intersects assumes that they are planar
"
"2","Joining, by = ""GEOID10""
"
"0","colnames(pge_elec_gas)"
"1","[1]"
"1"," ""ZIPCODE""       "
"1"," ""MONTH""         "
"1"," ""YEAR""          "
"1"," ""CUSTOMERCLASS"" "
"1","
"
"1","[5]"
"1"," ""COMBINED""      "
"1"," ""TOTALCUSTOMERS"""
"1"," ""TOTALKBTU""     "
"1","
"
"0","pge_rc_bayzips <-"
"0","  pge_elec_gas %>% "
"0","  filter(CUSTOMERCLASS %in% c(""Gas- Residential"", ""Elec- Residential"", ""Gas- Commercial"", ""Elec- Commercial"")) %>% "
"0","  mutate("
"0","    ZIPCODE = ZIPCODE %>% as.character()"
"0","  ) %>% "
"0","  group_by(ZIPCODE, CUSTOMERCLASS, MONTH, YEAR) %>% "
"0","  summarize("
"0","    TOTALKBTU = sum(TOTALKBTU, na.rm = T)"
"0","  ) %>% "
"0","  right_join("
"0","    bay_zips %>% select(GEOID10),"
"0","    by = c(""ZIPCODE"" = ""GEOID10"")"
"0","  ) %>% "
"0","  ungroup()"
"2","`summarise()` regrouping output by 'ZIPCODE', 'CUSTOMERCLASS', 'MONTH' (override with `.groups` argument)
"
"0","  "
"0","  "
"0","class(pge_rc_bayzips$ZIPCODE)"
"1","[1]"
"1"," ""character"""
"1","
"
